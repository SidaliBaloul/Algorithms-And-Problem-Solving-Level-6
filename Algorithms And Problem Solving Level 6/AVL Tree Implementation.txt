using System;


class AVLNode
{
    public int Value { get; set; }
    public AVLNode Left { get; set; }
    public AVLNode Right { get; set; }
    public int Height { get; set; }

    public AVLNode(int value)
    {
        Value = value;
        Height = 1;
    }
}

class AVLTree
{
    private AVLNode root;

    public void Insert(int value)
    {
        root = Insert(root, value);
    }

    private AVLNode Insert(AVLNode node, int value)
    {
        if (node == null)
            return new AVLNode(value);


        if (value < node.Value)
            node.Left = Insert(node.Left, value);
        else if (value > node.Value)
            node.Right = Insert(node.Right, value);
        else
            return node; 

        UpdateHeight(node);
      
        return Balance(node);
    }

    private void UpdateHeight(AVLNode node)
    {
        
        node.Height = 1 + Math.Max(Height(node.Left), Height(node.Right));
    }

    private int Height(AVLNode node)
    {
        return node != null ? node.Height : 0;
    }

    private int GetBalanceFactor(AVLNode node)
    {
        return (node != null) ? Height(node.Left) - Height(node.Right) : 0;
    }

    private AVLNode Balance(AVLNode node)
    {
      

        int balanceFactor = GetBalanceFactor(node);

        

        if (balanceFactor < -1 && GetBalanceFactor(node.Right) <= 0)
            return LeftRotate(node);


        if (balanceFactor > 1 && GetBalanceFactor(node.Left) >= 0)
            return RightRotate(node);


        if (balanceFactor > 1 && GetBalanceFactor(node.Left) < 0)
        {
           
            node.Left = LeftRotate(node.Left);
           
            return RightRotate(node);
        }

        
        if (balanceFactor < -1 && GetBalanceFactor(node.Right) > 0)
        {
            
            node.Right = RightRotate(node.Right);
            
            return LeftRotate(node);
        }

        return node;
    }

    private AVLNode RightRotate(AVLNode OriginalRoot)
    {

        
        AVLNode NewRoot = OriginalRoot.Left;

        
        AVLNode OriginalRightChild = NewRoot.Right;


        
        NewRoot.Right = OriginalRoot;

       
        OriginalRoot.Left = OriginalRightChild;

        UpdateHeight(OriginalRoot);
        UpdateHeight(NewRoot);

        
        return NewRoot;
    }

    private AVLNode LeftRotate(AVLNode OriginalRoot)
    {


        
        AVLNode NewRoot = OriginalRoot.Right;
        
        AVLNode OriginalLeftChild = NewRoot.Left;

      
        NewRoot.Left = OriginalRoot;
        
        
        OriginalRoot.Right = OriginalLeftChild;

      
        UpdateHeight(OriginalRoot);
        UpdateHeight(NewRoot);

        
        return NewRoot;
    }


    public void Delete(int value)
    {
        root = DeleteNode(root, value);
    }

    private AVLNode DeleteNode(AVLNode node, int value)
    {
        if (node == null)
        {
            return node;
        }

        
        if (value < node.Value)
        {
            node.Left = DeleteNode(node.Left, value);
        }
        else if (value > node.Value)
        {
            node.Right = DeleteNode(node.Right, value);
        }
        else
        {
           
            if (node.Left == null)
            {
                return node.Right;
            }
            else if (node.Right == null)
            {
                return node.Left;
            }

            
            AVLNode temp = MinValueNode(node.Right);

            
            node.Value = temp.Value;

            node.Right = DeleteNode(node.Right, temp.Value);
        }

       
        UpdateHeight(node);

       
        return Balance(node);
    }

    private AVLNode MinValueNode(AVLNode node)
    {
        
        AVLNode current = node;
        while (current.Left != null)
        {
            current = current.Left;
        }
        return current;
    }

    
    public bool Exists(int value)
    {
        return Exists(root, value);
    }

    
    private bool Exists(AVLNode node, int value)
    {
        if (node == null)
        {
            return false; 
        }

        if (value < node.Value)
        {
            return Exists(node.Left, value); 
        }
        else if (value > node.Value)
        {
            return Exists(node.Right, value); 
        }
        else
        {
            return true;
        }
    }


  
    public AVLNode Search(int value)
    {
        return Search(root, value);
    }

    
    private AVLNode Search(AVLNode node, int value)
    {
        if (node == null)
        {
            return null; 
        }

        if (value < node.Value)
        {
            return Search(node.Left, value); 
        }
        else if (value > node.Value)
        {
            return Search(node.Right, value); 
        }
        else
        {
            return node; 
        }
    }


    public void PrintTree()
    {
        PrintTree(root, "", true);
    }

    private void PrintTree(AVLNode node, string indent, bool last)
    {
        if (node != null)
        {
            Console.Write(indent);
            if (last)
            {
                Console.Write("R----");
                indent += "     ";
            }
            else
            {
                Console.Write("L----");
                indent += "|    ";
            }
            Console.WriteLine(node.Value);
            PrintTree(node.Left, indent, false);
            PrintTree(node.Right, indent, true);
        }
    }
}

class Program
{
    static void Main(string[] args)
    {
        AVLTree tree = new AVLTree();

        
        int[] values = { 10, 20, 30, 40, 50, 25 };
        foreach (var value in values)
        {
            tree.Insert(value);
        }

        tree.PrintTree();

        
        int searchValue = 30;
        bool found = tree.Exists(searchValue);
        Console.WriteLine($"\nSearch for value {searchValue}: " + (found ? "Found" : "Not Found"));

        searchValue = 60;
        found = tree.Exists(searchValue);
        Console.WriteLine($"Search for value {searchValue}: " + (found ? "Found" : "Not Found"));



        
        int searchValue2 = 30;
        AVLNode foundNode = tree.Search(searchValue2);
        Console.WriteLine($"\nSearch for value {searchValue2}: " + (foundNode != null ? $"Found node with value: {foundNode.Value}" : "Not Found"));

        searchValue2 = 60;
        foundNode = tree.Search(searchValue);
        Console.WriteLine($"Search for value {searchValue2}: " + (foundNode != null ? $"Found node with value: {foundNode.Value}" : "Not Found"));

        Console.ReadKey();

    }
}