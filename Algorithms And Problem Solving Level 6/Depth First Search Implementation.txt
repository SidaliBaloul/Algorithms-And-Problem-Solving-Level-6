using System;
using System.Collections.Generic;

class Graph
{
    public enum enGraphDirectionType { Directed, unDirected }

    private int[,] _adjacencyMatrix; 
    private Dictionary<string, int> _vertexDictionary; 
    private int _numberOfVertices; 
    private enGraphDirectionType _GraphDirectionType = enGraphDirectionType.unDirected;

    
    public Graph(List<string> vertices, enGraphDirectionType GraphDirectionType)
    {
        _GraphDirectionType = GraphDirectionType;
        _numberOfVertices = vertices.Count; 
        _adjacencyMatrix = new int[_numberOfVertices, _numberOfVertices]; 
        _vertexDictionary = new Dictionary<string, int>(); 

        
        for (int i = 0; i < vertices.Count; i++)
        {
            _vertexDictionary[vertices[i]] = i;
        }
    }

   
    public void AddEdge(string source, string destination, int weight)
    {
        if (_vertexDictionary.ContainsKey(source) && _vertexDictionary.ContainsKey(destination))
        {
            int sourceIndex = _vertexDictionary[source];
            int destinationIndex = _vertexDictionary[destination];
            _adjacencyMatrix[sourceIndex, destinationIndex] = weight;

            
            if (_GraphDirectionType == enGraphDirectionType.unDirected)
            {
                _adjacencyMatrix[destinationIndex, sourceIndex] = weight;
            }
        }
        else
        {
            Console.WriteLine($"Invalid vertices: {source} or {destination}");
        }
    }


    public void DisplayGraph(string message)
    {
        Console.WriteLine("\n" + message + "\n");
        Console.Write("  ");
        foreach (var vertex in _vertexDictionary.Keys)
        {
            Console.Write(vertex + " ");
        }
        Console.WriteLine();

        foreach (var source in _vertexDictionary)
        {
            Console.Write(source.Key + " ");
            for (int j = 0; j < _numberOfVertices; j++)
            {
                Console.Write(_adjacencyMatrix[source.Value, j] + " ");
            }
            Console.WriteLine();
        }
    }

    
    public void BFS(string startVertex)
    {
        if (!_vertexDictionary.ContainsKey(startVertex))
        {
            Console.WriteLine("Invalid start vertex.");
            return;
        }

        bool[] visited = new bool[_numberOfVertices]; 
        Queue<int> queue = new Queue<int>(); 
        int startIndex = _vertexDictionary[startVertex];
        visited[startIndex] = true; 
        queue.Enqueue(startIndex);

        Console.WriteLine("\nBreadth-First Search:");

        while (queue.Count > 0)
        {
            int currentVertex = queue.Dequeue();
            Console.Write($"{GetVertexName(currentVertex)} "); 

            for (int i = 0; i < _numberOfVertices; i++)
            {
                if (_adjacencyMatrix[currentVertex, i] > 0 && !visited[i])
                {
                    visited[i] = true;
                    queue.Enqueue(i);
                }
            }
        }

        Console.WriteLine();
    }

   
    public void DFS(string startVertex)
    {
        if (!_vertexDictionary.ContainsKey(startVertex))
        {
            Console.WriteLine("Invalid start vertex.");
            return;
        }

        bool[] visited = new bool[_numberOfVertices]; 

        Stack<int> stack = new Stack<int>(); 

        int startIndex = _vertexDictionary[startVertex];
        stack.Push(startIndex);


        Console.WriteLine("\nDepth-First Search:");

        while (stack.Count > 0)
        {
            int currentVertex = stack.Pop();

         
            if (visited[currentVertex])
                continue;

            visited[currentVertex] = true; 
            Console.Write($"{GetVertexName(currentVertex)} "); 

            
            for (int i = _numberOfVertices - 1; i >= 0; i--) 
            {
                if (_adjacencyMatrix[currentVertex, i] > 0 && !visited[i])
                {
                    stack.Push(i);
                }
            }
        }

        Console.WriteLine();
    }

  
    private string GetVertexName(int index)
    {
        foreach (var pair in _vertexDictionary)
        {
            if (pair.Value == index)
                return pair.Key;
        }
        return null;
    }

    
    public static void Main(string[] args)
    {
        List<string> vertices = new List<string> { "0", "1", "2", "3", "4" };

        
        Graph graph = new Graph(vertices, enGraphDirectionType.unDirected);

        graph.AddEdge("0", "1", 1);
        graph.AddEdge("0", "2", 1);
        graph.AddEdge("0", "3", 1);

        graph.AddEdge("2", "3", 1);
        graph.AddEdge("2", "4", 1);


      
        graph.DisplayGraph("Adjacency Matrix (Undirected Graph):");

       
        graph.DFS("0");

        Console.ReadKey();
    }
}